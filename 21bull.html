<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TWENTY-ONE: Security Edition</title>
    <style>
        :root {
            --bg: #f8fafc;
            --card: #ffffff;
            --accent: #6366f1;
            --strike: #2ecc71;
            --ball: #f1c40f;
            --out: #e74c3c;
            --seg-off: #e2e8f0;
            --seg-on: #6366f1;
            --text-main: #1e293b;
            --text-sub: #64748b;
        }

        body {
            font-family: 'Pretendard', -apple-system, sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            user-select: none;
            -webkit-user-select: none;
        }

        .container {
            max-width: 500px;
            width: 100%;
            background: var(--card);
            padding: 30px 20px;
            border-radius: 32px;
            box-shadow: 0 20px 25px -5px rgba(0,0,0,0.05);
            text-align: center;
        }

        h1 { 
            font-size: 2rem; 
            font-weight: 900; 
            background: linear-gradient(90deg, #6366f1, #a855f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .subtitle { color: var(--text-sub); font-size: 0.9rem; margin-top: 5px; font-weight: 500; }
        .hint { color: var(--accent); font-size: 0.8rem; margin-top: 15px; font-weight: 600; opacity: 0.8; }

        .game-board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 25px 0;
            padding: 15px;
            background: #f1f5f9;
            border-radius: 24px;
        }

        .slot-wrapper { display: flex; flex-direction: column; align-items: center; gap: 10px; }
        .indicator { width: 28px; height: 28px; border-radius: 50%; background: #cbd5e1; display: flex; justify-content: center; align-items: center; font-weight: 800; font-size: 12px; color: white; transition: all 0.3s; }
        .indicator.s { background: var(--strike); }
        .indicator.b { background: var(--ball); }
        .indicator.o { background: var(--out); }

        .slot {
            width: 100%;
            aspect-ratio: 2 / 3;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 16px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .segment-display { position: relative; width: 30px; height: 60px; transform: scale(1.1); pointer-events: none; }
        .seg { position: absolute; background: var(--seg-off); border-radius: 10px; }
        .seg.a { top: 0; left: 4px; width: 22px; height: 4px; }
        .seg.b { top: 4px; right: 0; width: 4px; height: 22px; }
        .seg.c { bottom: 4px; right: 0; width: 4px; height: 22px; }
        .seg.d { bottom: 0; left: 4px; width: 22px; height: 4px; }
        .seg.e { bottom: 4px; left: 0; width: 4px; height: 22px; }
        .seg.f { top: 4px; left: 0; width: 4px; height: 22px; }
        .seg.g { top: 28px; left: 4px; width: 22px; height: 4px; }
        .seg.on { background: var(--seg-on); }

        .switch-pool { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; min-height: 70px; padding: 15px; background: #f8fafc; border: 2px dashed #e2e8f0; border-radius: 20px; }
        .switch { width: 50px; height: 50px; background: white; border: 1px solid #e2e8f0; border-radius: 12px; display: flex; justify-content: center; align-items: center; box-shadow: 0 4px 6px rgba(0,0,0,0.05); transition: all 0.2s; cursor: pointer; }
        .switch.selected { border-color: var(--accent); background: #f5f3ff; transform: scale(1.1); }

        .controls { margin-top: 30px; display: flex; gap: 12px; }
        button { flex: 1; padding: 15px; border: none; border-radius: 16px; font-size: 0.9rem; font-weight: 800; cursor: pointer; transition: 0.2s; }
        #play-btn { background: var(--accent); color: white; }
        .reset-btn { background: #e2e8f0; color: #475569; }
        #chance-info { font-weight: 700; color: var(--text-sub); margin-top: 15px; font-size: 0.9rem; }
    </style>
</head>
<body oncontextmenu="return false;">

<div class="container">
    <h1>TWENTY-ONE</h1>
    <div class="subtitle">ÎÑ§ÏûêÎ¶¨ Ïà´Ïûê ÏïºÍµ¨ Í≤åÏûÑÏûÖÎãàÎã§.</div>
    <div class="hint">üí° Î∂ÄÌíà ÏÑ†ÌÉù ÌõÑ Ïä¨Î°ØÏùÑ ÌÑ∞ÏπòÌïòÏÑ∏Ïöî!</div>

    <div class="game-board">
        <div class="slot-wrapper"><div class="indicator" id="ind-0"></div><div class="slot" id="slot-0" onclick="handleSlotClick(0)"></div></div>
        <div class="slot-wrapper"><div class="indicator" id="ind-1"></div><div class="slot" id="slot-1" onclick="handleSlotClick(1)"></div></div>
        <div class="slot-wrapper"><div class="indicator" id="ind-2"></div><div class="slot" id="slot-2" onclick="handleSlotClick(2)"></div></div>
        <div class="slot-wrapper"><div class="indicator" id="ind-3"></div><div class="slot" id="slot-3" onclick="handleSlotClick(3)"></div></div>
    </div>

    <div id="chance-info">CHANCES LEFT: 5</div>
    <div class="switch-pool" id="pool"></div>

    <div class="controls">
        <button id="play-btn" onclick="playBall()">PLAY BALL</button>
        <button class="reset-btn" onclick="resetGame()">RESET</button>
    </div>
</div>

<script>
    const _0x1a2b = "UjA5T1JVTlBURTlTVXc9PQ=="; 

    document.addEventListener('keydown', function(e) {
        if (e.keyCode == 123 || (e.ctrlKey && e.shiftKey && (e.keyCode == 73 || e.keyCode == 74 || e.keyCode == 67)) || (e.ctrlKey && e.keyCode == 85)) {
            e.preventDefault();
            return false;
        }
    });

    // 2. Í∞úÎ∞úÏûê ÎèÑÍµ¨ ÎîîÎ≤ÑÍπÖ Ï∞®Îã®
    setInterval(function() {
        const start = Date.now();
        debugger;
        if (Date.now() - start > 100) {
            location.reload();
        }
    }, 1000);

    /* --- GAME LOGIC --- */
    const SEG_DATA = {
        '0': [['a','b','f'], ['c','d','e']], '2': [['a','b','g'], ['g','e','d']],
        '3': [['a','b','g'], ['g','c','d']], '4': [['f','g','b'], ['g','b','c']],
        '5': [['a','f','g'], ['g','c','d']], '6': [['a','f','g'], ['e','d','c']],
        '7': [['a','b','c']], '9': [['a','b','f'], ['g','c','d']]
    };

    let target = [];
    let chances = 5;
    let currentSlots = [[], [], [], []];
    let selectedSwitchId = null;

    function init() {
        const nums = ['0', '2', '3', '4', '5', '6', '9'];
        const others = nums.sort(() => Math.random() - 0.5).slice(0, 3);
        target = [...others, '7'].sort(() => Math.random() - 0.5);
        const pool = document.getElementById('pool');
        pool.innerHTML = '';
        let allSwitches = [];
        target.forEach(n => {
            SEG_DATA[n].forEach(segs => {
                allSwitches.push({ id: 'sw-' + Math.random().toString(36).substr(2, 5), segs });
            });
        });
        allSwitches.sort(() => Math.random() - 0.5).forEach(sw => {
            const el = document.createElement('div');
            el.className = 'switch'; el.id = sw.id;
            el.dataset.segs = JSON.stringify(sw.segs);
            el.innerHTML = renderSegIcon(sw.segs, 0.35);
            el.onclick = () => toggleSwitchSelection(sw.id);
            pool.appendChild(el);
        });
        updateDisplay();
    }

    function renderSegIcon(activeSegs, scale = 1) {
        let html = `<div class="segment-display" style="transform: scale(${scale})">`;
        ['a','b','c','d','e','f','g'].forEach(s => {
            html += `<div class="seg ${s} ${activeSegs.includes(s) ? 'on' : ''}"></div>`;
        });
        return html + '</div>';
    }

    function toggleSwitchSelection(id) {
        if (selectedSwitchId === id) {
            document.getElementById(id).classList.remove('selected');
            selectedSwitchId = null;
        } else {
            if (selectedSwitchId) document.getElementById(selectedSwitchId).classList.remove('selected');
            selectedSwitchId = id;
            document.getElementById(id).classList.add('selected');
        }
    }

    function handleSlotClick(idx) {
        if (selectedSwitchId) {
            const swEl = document.getElementById(selectedSwitchId);
            if (currentSlots[idx].length < 2) {
                currentSlots[idx].push({ id: swEl.id, segs: JSON.parse(swEl.dataset.segs) });
                swEl.style.display = 'none';
                swEl.classList.remove('selected');
                selectedSwitchId = null;
                updateDisplay();
            }
        } else if (currentSlots[idx].length > 0) {
            currentSlots[idx].forEach(item => { document.getElementById(item.id).style.display = 'flex'; });
            currentSlots[idx] = [];
            document.getElementById(`ind-${idx}`).className = 'indicator';
            document.getElementById(`ind-${idx}`).innerText = '';
            updateDisplay();
        }
    }

    function updateDisplay() {
        for (let i = 0; i < 4; i++) {
            const combined = [...new Set(currentSlots[i].flatMap(s => s.segs))];
            document.getElementById(`slot-${i}`).innerHTML = renderSegIcon(combined, 1.0);
        }
    }

    function playBall() {
        let guess = currentSlots.map(slot => {
            const combined = [...new Set(slot.flatMap(s => s.segs))].sort().join('');
            for (let num in SEG_DATA) {
                const targetMatch = [...new Set(SEG_DATA[num].flat())].sort().join('');
                if (combined === targetMatch) return num;
            }
            return null;
        });

        if (guess.includes(null)) return alert("ÏãúÏä§ÌÖú Ï†ïÎ†¨ÏùÑ ÏôÑÎ£åÌïòÏã≠ÏãúÏò§.");

        let strikeCount = 0;
        guess.forEach((num, i) => {
            const ind = document.getElementById(`ind-${i}`);
            if (num === target[i]) {
                ind.className = 'indicator s'; ind.innerText = 'S';
                strikeCount++;
            } else if (target.includes(num)) {
                ind.className = 'indicator b'; ind.innerText = 'B';
            } else {
                ind.className = 'indicator o'; ind.innerText = 'O';
            }
        });

        if (strikeCount === 4) {
            const res = atob(atob(_0x1a2b));
            alert("Ï†ïÎãµÏûÖÎãàÎã§! ÏßÑÌñâ ÏΩîÎìú: " + res);
            document.getElementById('play-btn').disabled = true;
        } else {
            chances--;
            document.getElementById('chance-info').innerText = `CHANCES LEFT: ${chances}`;
            if (chances <= 0) {
                alert("ACCESS DENIED");
                resetGame();
            }
        }
    }

    function resetGame() {
        chances = 5;
        currentSlots = [[], [], [], []];
        selectedSwitchId = null;
        document.getElementById('chance-info').innerText = `CHANCES LEFT: 5`;
        document.getElementById('play-btn').disabled = false;
        document.querySelectorAll('.indicator').forEach(i => { i.className = 'indicator'; i.innerText = ''; });
        init();
    }

    window.onload = init;
</script>
</body>
</html>
